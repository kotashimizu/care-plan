# 要件書

## はじめに

福祉分野における個別支援計画書作成を支援するセキュアなWebアプリケーションです。面談記録を入力として、経験豊富なサービス管理責任者の視点で高品質な個別支援計画書を生成します。データ保存を行わず、出力のみを提供することでセキュリティを確保します。

## 要件

### 要件1

**ユーザーストーリー:** サービス管理責任者として、面談記録を入力して個別支援計画書を自動生成したい。そうすることで、計画書作成の時間を短縮し、より質の高い支援に集中できる。

#### 受入基準

1. 面談記録のテキスト入力フィールドが提供される時、システムは入力内容を受け取る
2. 生成ボタンがクリックされた時、システムはAI APIを呼び出して個別支援計画書を生成する
3. 生成が完了した時、システムは以下の項目を含む計画書を表示する：
   - 利用者及び家族の生活に対する意向
   - 総合的な援助の方針
   - 長期目標（1年）
   - 短期目標（6ヶ月）
   - 支援目標1（就労支援）
   - 支援目標2（日常生活支援）
   - 支援目標3（社会生活支援）

### 要件2

**ユーザーストーリー:** 福祉事業所の管理者として、利用者の個人情報が外部に保存されないことを確認したい。そうすることで、個人情報保護法に準拠した安全な運用ができる。

#### 受入基準

1. 面談記録が入力された時、システムはデータをローカルメモリのみで処理する
2. AI API呼び出し後、システムは入力データと生成結果をサーバーに保存しない
3. ページがリロードされた時、システムは以前の入力内容と生成結果を保持しない
4. セッション終了時、システムはすべてのデータを完全に削除する

### 要件3

**ユーザーストーリー:** サービス管理責任者として、事業所の特性に応じた計画書を生成したい。そうすることで、より実情に合った支援計画を作成できる。

#### 受入基準

1. 事業所種別選択（就労継続支援A型/B型、就労移行支援、生活介護等）が提供される時、システムは選択内容を記録する
2. 主な作業内容選択（軽作業、PC作業、清掃作業等）が提供される時、システムは選択内容を記録する
3. 利用者特性設定（障害種別、年齢層）が提供される時、システムは選択内容を記録する
4. 生成時、システムは設定された特性に応じてプロンプトをカスタマイズする

### 要件4

**ユーザーストーリー:** サービス管理責任者として、生成された計画書をコピー&ペーストで利用したい。そうすることで、既存の文書作成システムに効率的に転記できる。

#### 受入基準

1. 計画書が生成された時、システムは各項目を個別にコピー可能な形式で表示する
2. コピーボタンがクリックされた時、システムは該当項目の内容をクリップボードにコピーする
3. 全体コピーボタンがクリックされた時、システムは計画書全体をクリップボードにコピーする
4. コピー完了時、システムは視覚的なフィードバックを提供する

### 要件5

**ユーザーストーリー:** サービス管理責任者として、生成された計画書の品質を確認したい。そうすることで、実地指導に対応できる適切な内容であることを確認できる。

#### 受入基準

1. 計画書生成時、システムは品質スコア（専門性、具体性、実現可能性、一貫性）を表示する
2. 品質チェック機能が実行された時、システムは法的要件、専門性、利用者中心性の観点から評価を提供する
3. 改善提案が要求された時、システムは具体的な修正案を提示する
4. 代替案生成が要求された時、システムは就労重視型、生活重視型、社会参加重視型の3つの代替案を生成する

### 要件6

**ユーザーストーリー:** 福祉事業所の職員として、レスポンシブデザインで様々なデバイスから利用したい。そうすることで、タブレットやスマートフォンからも計画書を作成できる。

#### 受入基準

1. デスクトップ画面でアクセスした時、システムは最適化されたレイアウトを表示する
2. タブレット画面でアクセスした時、システムはタッチ操作に適したUIを提供する
3. スマートフォン画面でアクセスした時、システムは縦向きレイアウトに対応する
4. 画面サイズが変更された時、システムは動的にレイアウトを調整する

### 要件7

**ユーザーストーリー:** システム管理者として、AI API呼び出しのエラーハンドリングが適切に行われることを確認したい。そうすることで、安定したサービス提供ができる。

#### 受入基準

1. AI APIが利用不可の時、システムは分かりやすいエラーメッセージを表示する
2. ネットワークエラーが発生した時、システムは再試行オプションを提供する
3. API制限に達した時、システムは制限解除までの待機時間を表示する
4. 入力内容が不適切な時、システムは具体的な修正指示を提供する
5. **✅ 実装済み** APIタイムアウト（504エラー）が発生した時、システムは適切なエラーメッセージを表示し、ユーザーに再試行を促す

### 要件8

**ユーザーストーリー:** サービス管理責任者として、生成された計画書の内容を編集したい。そうすることで、個別の状況に応じた微調整ができる。

#### 受入基準

1. 計画書が生成された時、システムは各項目を編集可能な形式で表示する
2. 編集モードが有効化された時、システムはテキスト編集機能を提供する
3. 編集内容が保存された時、システムは変更を反映した表示に更新する
4. 編集をキャンセルした時、システムは元の内容に復元する

### 要件9

**ユーザーストーリー:** サービス管理責任者として、完成した計画書をPDF形式で出力したい。そうすることで、公式文書として印刷・提出できる。

#### 受入基準

1. PDF出力ボタンがクリックされた時、システムは計画書をPDF形式で生成する
2. PDFファイルには事業所情報、作成日時、ページ番号が含まれる
3. PDF形式は印刷に適したA4サイズで作成される
4. PDF生成が完了した時、システムは自動ダウンロードを開始する